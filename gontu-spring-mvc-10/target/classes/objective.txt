Use Map instead of separate arguments to capture template variables